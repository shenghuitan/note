# 事务的替代方案

## 理解事务

事务的特性：原子性、隔离性、一致性、持久性。

在应用程序设计的时候，我们经常会舍弃带事务的架构，因为会认为事务会带来大量的性能损失。  
那是因为系统都是分布式的，而且数据并不仅仅只是在一个分区上，所以这里所说的事务，便是XA事务了。

还有就是即使是单分区事务，事务的语义已经完全由数据库所覆盖，但是还会有另一种声音：  
如果后续系统扩展，这里将会是系统的瓶颈，这等同于提前埋下了技术债。  
这似乎很有道理，实际上很多系统都活不到需要被扩展的那一天。

## 提交与回滚

提交与回滚，事务执行的两个重点。  
原子性、隔离性、一致性、持久性，基本上都可以被收拢到这两个操作上来。

## 实现提交与回滚

是否实现了提交与回滚，就可以认为是事务可替代的呢？

提交的部分，我们是已经实现的了。  
回滚的部分，由数据库代理执行。  
当提交在数据库内部执行失败，数据会把数据恢复到事务创建时的快照的状态。

那如果应用程序实现了回滚，就是实现了事务了呢？

## 数据库的回滚

数据库的回滚之所以可以更有效，是因为数据在提交成功之前，仅仅只是写入到了日志，而没有写入到最终的文件存储。  
所以，数据库的回滚，可以理解成仅仅只是把部分日志丢失，对结果本身没有产生任何的影响。

## 应用程序的回滚

那如果是应用程序来实现回滚，那就相当于类似的事务补偿操作，利用再次提交来替代回滚。  
应用程序的回滚，如果是尝试更新或删除操作，怎么去保证更新和删除，是和数据库当时的快照是一致的呢？

## 永不停止的回滚
如果由于提交失败而导致的回滚，那回滚是否也会失败，从而数据一直处于不断回滚的状态，因回滚失败而继续回滚。

## 未完成

